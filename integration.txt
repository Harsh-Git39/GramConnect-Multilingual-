# Complete Supabase Integration Guide for GramConnect
*No SQL knowledge required - everything through visual interface*

## Step 1: Create Supabase Account & Project

### 1.1 Sign Up
1. Go to [supabase.com](https://supabase.com)
2. Click "Start your project"
3. Sign up with GitHub/Google or email
4. Verify your email if needed

### 1.2 Create New Project
1. Click "New Project"
2. Choose your organization (usually your username)
3. Fill in project details:
   - **Name**: `gramconnect`
   - **Database Password**: Create a strong password (save this!)
   - **Region**: Choose closest to your location
4. Click "Create new project"
5. Wait 2-3 minutes for setup to complete

## Step 2: Get Your Project Credentials

### 2.1 Find Your Project Settings
1. In your project dashboard, click "Settings" (gear icon) in sidebar
2. Click "API" under Project Settings
3. You'll see two important values:
   - **Project URL**: `https://your-project-id.supabase.co`
   - **anon public key**: `eyJhbGci...` (very long key)
4. **COPY AND SAVE THESE** - you'll need them in your Node.js code

## Step 3: Create Database Tables (Visual Interface)

### 3.1 Create Profiles Table
1. Go to "Table Editor" in sidebar
2. Click "Create a new table"
3. **Table name**: `profiles`
4. Click "Add column" for each field:

| Column Name | Type | Default Value | Primary | Nullable | Unique |
|-------------|------|---------------|---------|----------|--------|
| id | uuid | `gen_random_uuid()` | âœ… | âŒ | âœ… |
| name | text | (empty) | âŒ | âŒ | âŒ |
| email | text | (empty) | âŒ | âŒ | âœ… |
| phone | text | (empty) | âŒ | âœ… | âŒ |
| location | text | (empty) | âŒ | âœ… | âŒ |
| user_type | text | (empty) | âŒ | âŒ | âŒ |
| created_at | timestamptz | `now()` | âŒ | âŒ | âŒ |

5. Click "Save" to create table

### 3.2 Create Jobs Table
1. Click "Create a new table"
2. **Table name**: `jobs`
3. Add these columns:

| Column Name | Type | Default Value | Primary | Nullable | Unique |
|-------------|------|---------------|---------|----------|--------|
| id | uuid | `gen_random_uuid()` | âœ… | âŒ | âœ… |
| farmer_id | uuid | (empty) | âŒ | âŒ | âŒ |
| title | text | (empty) | âŒ | âŒ | âŒ |
| description | text | (empty) | âŒ | âœ… | âŒ |
| duration | text | (empty) | âŒ | âœ… | âŒ |
| pay_rate | int4 | (empty) | âŒ | âœ… | âŒ |
| location | text | (empty) | âŒ | âœ… | âŒ |
| created_at | timestamptz | `now()` | âŒ | âŒ | âŒ |

4. **Important**: For `farmer_id` column:
   - After creating, click the column name
   - Scroll down to "Foreign Key Relation"
   - **Reference table**: `profiles`
   - **Reference column**: `id`
   - Click "Save"

5. Click "Save" to create table

### 3.3 Create Job Applications Table
1. Click "Create a new table"
2. **Table name**: `job_applications`
3. Add these columns:

| Column Name | Type | Default Value | Primary | Nullable | Unique |
|-------------|------|---------------|---------|----------|--------|
| id | uuid | `gen_random_uuid()` | âœ… | âŒ | âœ… |
| job_id | uuid | (empty) | âŒ | âŒ | âŒ |
| worker_id | uuid | (empty) | âŒ | âŒ | âŒ |
| applied_at | timestamptz | `now()` | âŒ | âŒ | âŒ |

4. **Add Foreign Key Relations**:
   - For `job_id`: Reference table `jobs`, column `id`
   - For `worker_id`: Reference table `profiles`, column `id`

5. Click "Save" to create table

## Step 4: Configure Authentication

### 4.1 Enable Email Authentication
1. Go to "Authentication" â†’ "Settings" in sidebar
2. Under "Auth Providers", make sure **Email** is enabled (should be by default)
3. Scroll to "Email Auth Settings"
4. **Confirm email**: Turn OFF (for easier testing)
5. Click "Save"

### 4.2 Set Up Row Level Security (RLS)
1. Go back to "Table Editor"
2. For each table (`profiles`, `jobs`, `job_applications`):
   - Click the table name
   - Click "Settings" tab
   - Toggle "Enable Row Level Security" to ON
   - Click "Save"

## Step 5: Install Supabase in Your Project

### 5.1 Install Supabase Package
Open terminal in your project folder and run:
```bash
npm install @supabase/supabase-js
```

### 5.2 Install Other Required Packages
```bash
npm install express cors
```

## Step 6: Update Your Backend Code

### 6.1 Add Your Credentials
In your backend code, replace these lines:
```javascript
const supabaseUrl = 'your-supabase-url-here';
const supabaseKey = 'your-supabase-key-here';
```

With your actual credentials from Step 2:
```javascript
const supabaseUrl = 'https://your-project-id.supabase.co';
const supabaseKey = 'eyJhbGci...your-actual-key...';
```

### 6.2 Update Package.json
Create or update your `package.json`:
```json
{
  "name": "gramconnect-backend",
  "version": "1.0.0",
  "description": "GramConnect Backend Server",
  "main": "server.js",
  "scripts": {
    "start": "node server.js",
    "dev": "node server.js"
  },
  "dependencies": {
    "@supabase/supabase-js": "^2.0.0",
    "express": "^4.18.0",
    "cors": "^2.8.5"
  }
}
```

## Step 7: Test Your Setup

### 7.1 Test Database Connection
Create a simple test file `test-db.js`:
```javascript
const { createClient } = require('@supabase/supabase-js');

const supabaseUrl = 'https://your-project-id.supabase.co';
const supabaseKey = 'your-actual-key';
const supabase = createClient(supabaseUrl, supabaseKey);

async function testConnection() {
    try {
        const { data, error } = await supabase
            .from('profiles')
            .select('*')
            .limit(1);
        
        if (error) {
            console.log('âŒ Database connection failed:', error.message);
        } else {
            console.log('âœ… Database connected successfully!');
            console.log('Tables are ready to use.');
        }
    } catch (err) {
        console.log('âŒ Error:', err.message);
    }
}

testConnection();
```

Run the test:
```bash
node test-db.js
```

### 7.2 Start Your Server
```bash
node server.js
```

You should see:
```
âœ… Server running on http://localhost:3000
ğŸ“Š Connected to Supabase database
```

## Step 8: Test User Registration

### 8.1 Test Signup Through Your App
1. Go to `http://localhost:3000`
2. Navigate to auth page
3. Try signing up a test user
4. Check Supabase dashboard â†’ Authentication â†’ Users to see if user was created
5. Check Table Editor â†’ profiles to see if profile was saved

### 8.2 Test Job Creation
1. Login as a farmer
2. Try creating a job
3. Check Table Editor â†’ jobs to see if job was saved

## Step 9: Common Issues & Solutions

### Issue 1: "Invalid API key"
- **Solution**: Double-check you copied the correct `anon public` key from Settings â†’ API

### Issue 2: "Permission denied"
- **Solution**: Make sure Row Level Security is enabled but no policies are set (for testing)

### Issue 3: "Table doesn't exist"
- **Solution**: Verify table names are exactly: `profiles`, `jobs`, `job_applications`

### Issue 4: "Foreign key constraint"
- **Solution**: Make sure foreign key relationships are set up correctly in Step 3

### Issue 5: "Connection timeout"
- **Solution**: Check your internet connection and Supabase project status

## Step 10: Production Setup (Optional)

### 10.1 Environment Variables
Create `.env` file:
```
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_ANON_KEY=your-actual-key
PORT=3000
```

Update your server.js:
```javascript
require('dotenv').config();

const supabaseUrl = process.env.SUPABASE_URL;
const supabaseKey = process.env.SUPABASE_ANON_KEY;
const PORT = process.env.PORT || 3000;
```

Install dotenv:
```bash
npm install dotenv
```

## Step 11: Verify Everything Works

### âœ… Checklist
- [ ] Supabase project created
- [ ] Database tables created with correct columns
- [ ] Foreign key relationships set up
- [ ] Row Level Security enabled
- [ ] Supabase credentials added to code
- [ ] Test connection successful
- [ ] Server starts without errors
- [ ] User signup works
- [ ] User login works
- [ ] Job creation works
- [ ] Job applications work

## ğŸ‰ Congratulations!

Your GramConnect app is now fully integrated with Supabase! You have:
- âœ… User authentication system
- âœ… Database storage for users, jobs, and applications
- âœ… Real-time data sync
- âœ… Secure API endpoints

## Next Steps
1. Test all features thoroughly
2. Add proper error handling
3. Style your frontend
4. Deploy to production (Vercel, Netlify, etc.)

## Support
- Supabase Documentation: [docs.supabase.com](https://docs.supabase.com)
- Supabase Discord: [discord.supabase.com](https://discord.supabase.com)